<script>
  class Subscribe extends HTMLElement {
    constructor() {
      super();

      const shadow = this.attachShadow({ mode: 'open' })
      const wrapper = this.render();
      const styles = this.styles();

      shadow.appendChild(wrapper);
      shadow.appendChild(styles);
    }

    renderMsg() {
      const msg = document.createElement('span')
      msg.innerHTML = `hello from micro-frontend C!`
      return msg;
    }

    renderForm() {
      const form = document.createElement('form')
      form.id = 'c__form'

      form.onsubmit = (ev) => {
        ev.preventDefault();
        const value = this.shadowRoot.getElementById('c__form').amount.value
        
        const event = new Event('c__submit')
        window.dispatchEvent(event)
      }

      form.innerHTML = `
        <form>
          <label for="c__amount">Increase the counter</label>
          <input id="c__amount" type="number" name="amount" value="1" />
          <button type="submit">submit!</button>  
        </form>
      `
      
      return form
    }

    render() {
      const wrapper = document.createElement('div')
      wrapper.className = 'container';

      wrapper.appendChild(this.renderMsg())
      wrapper.appendChild(this.renderForm())

      return wrapper;
    }

    styles() {
      const style = document.createElement('style');

      style.textContent = `
          .container {
            background: #4caf50;
            color: #000;
            padding: 1rem;
          }
        `;

      return style;
    }
  }

  customElements.define('c-subscribe', Subscribe)
</script>